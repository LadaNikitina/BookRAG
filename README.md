# Проект BookRAG

Команда "Bookworms"

Участники: Леднева Дарья, Федотова Евгения, Клименченко Дмитрий

## Описание проекта

Чат-бот для ответов на вопросы по книге Федора Михайловича Достоевского "Братья Карамазовы". Пользователь
задает вопросы по сюжету/персонажам книги, ассистент предоставляет ответ на основе базы знаний по книге, с указанием
глав/частей книги, на основе которых был сформирован ответ.

### Использованные технологии

FAISS, LangChain, Streamlit

## Важное замечание

Мы понимаем, что далеко не у всех есть возможность запустить VPN или оплатить API ключ OpenAI и потестировать наш BookRAG. В случае, если у вас такой возможности нет, мы подготовили для вас реализацию на основе GigaChat. Нужно всего лишь перейти по [ссылке](https://github.com/LadaNikitina/BookRAG/tree/giga-main) (она же ветка giga-main) и продолжить оценивать наш проект :) 

P.S. Тем более, что реализация на GigaChat быстрее работает ^_^

## Демо проекта

Демо проекта можно посмотреть по [ссылке](https://drive.google.com/file/d/1vo0ggH95uGgEKx4H_Fntg8SOLOCva6tk/view?usp=sharing). Записано для Giga-BookRAG, реализованного на основе GigaChat.

## Конечный результат

Развернуто локальное решение с frontend'ом, реализованным с помощью технологии Streamlit. В рамках решения реализован RAG в 2 версиях - на эмбеддингах и модели OpenAI, а также на эмбеддингах и модели GigaChat. Также, реализовано кеширование векторной базы - она будет построена лишь один раз и сохранена локально. В случае, если запуск будет произведен повторно и при этом чанки будут теми же, векторная база будет подгружена, что позволит сэкономить и время, и токены :)

## Метрики проекта (валидация RAG)

### **1. Faithfulness (достоверность)**  
**Faithfulness** — метрика, которая измеряет, насколько точно и достоверно ответ (или генерация) основан на предоставленном контексте. Она проверяет соответствие информации в ответе исходным данным, выявляя неточные или вымышленные утверждения.  

**Задачи Faithfulness:**  
- Сравнение ответа с контекстом.  
- Выявление галлюцинаций.  
- Проверка точности цитирования.  

### **2. Answer Relevancy (релевантность ответа)**  
**Answer relevancy** — метрика, оценивающая, насколько ответ модели релевантен заданному вопросу. Она определяет, отвечает ли модель на вопрос по существу, избегая отклонений от темы.  

**Задачи Answer Relevancy:**  
- Соответствие вопросу.  
- Отсутствие лишней информации в ответе.  
- Полнота ответа.  

### **Результаты тестирования**  
При использовании модели от OpenAI удалось достичь следующих показателей:  
- **Answer relevancy** — **0.91**  
- **Faithfulness** — **0.71**  

Эти результаты демонстрируют высокую релевантность ответов при умеренном уровне достоверности, что указывает на необходимость дальнейших улучшений в точности цитирования и предотвращении галлюцинаций.  

При использовании же модели от Gigachat удалось достичь следующих показателей:  
- **Answer relevancy** — **0.79**  
- **Faithfulness** — **0.52**

Модель GigaChat демонстрирует умеренную релевантность при низкой достоверности, что также указывает на необходимость доработки в точности цитирования и предотвращении галлюцинаций.

## Запуск приложения

### OpenAI API key

Для генерации ответов на вопросы наше решение использует модель от OpenAI, поэтому для использования чат-бота требуется
иметь собственный OpenAI API ключ, который может быть сгенерирован и оплачен
здесь: https://platform.openai.com/docs/overview

### Установка зависимостей

`pip install streamlit streamlit-chat`

`pip install langchain`

`pip install -U langchain-community`

`pip install sentence-transformers`

`pip install faiss-gpu`

`pip install openai`

`pip install langchain_openai`

`pip install pypdf`

`pip install tiktoken`

### Запуск и setup

Включите VPN, если он вам требуется для использования OpenAI.

Далее, для запуска приложения воспользуйтесь командой:

`streamlit run rag-solution-with-streamlit.py
`

Steamlit-приложение автоматически развернется в вашем браузере на localhost.

Введите ваш OpenAI API ключ в соответствующее поле в интерфейсе веб-приложения:

![image](https://github.com/user-attachments/assets/5202ed3c-2544-45a6-86a0-bf61630def07)

После ввода корректного ключа будет произведена индексация книги и построена векторная база, необходимая для работы RAG.
После этого можно пользоваться чат-ботом и задавать интересующие вопросы.

## Работа приложения

В соответствующем поле введите ваш вопрос по книге Ф.М. Достоевского "Братья Карамазовы". Чатбот вернет ответ, состоящий
из непосредственно ответа на поставленный вопрос, цитаты из текста книги и источника цитаты.

![image](https://github.com/user-attachments/assets/208760a1-9746-469f-8bcb-84a67c437d01)

Наше приложение позволяет задавать неограниченное количество вопросов, поддерживая с ботом длительный диалог.

![image](https://github.com/user-attachments/assets/5c36df10-5e66-444a-a642-0fe3a821f600)

Для завершения диалога с чат-ботом введите "exit"/"выход"/"quit".

![image](https://github.com/user-attachments/assets/db83adb6-632b-487f-9fbd-404ff3282352)
