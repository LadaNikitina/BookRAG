# Проект BookRAG (GigaChat edition)

Команда "Bookworms"

Участники: Леднева Дарья, Федотова Евгения, Клименченко Дмитрий

## Описание проекта

Чат-бот для ответов на вопросы по книге Федора Михайловича Достоевского "Братья Карамазовы". Пользователь
задает вопросы по сюжету/персонажам книги, ассистент предоставляет ответ на основе базы знаний по книге, с указанием
глав/частей книги, на основе которых был сформирован ответ.

### Использованные технологии

FAISS, LangChain, Streamlit

## Демо проекта

Демо проекта можно посмотреть по [ссылке](https://drive.google.com/file/d/1vo0ggH95uGgEKx4H_Fntg8SOLOCva6tk/view?usp=sharing). Записано для Giga-BookRAG, реализованного на основе GigaChat.

## Конечный результат

Развернуто локальное решение с frontend'ом, реализованным с помощью технологии Streamlit. В рамках решения реализован RAG в 2 версиях - на эмбеддингах и модели OpenAI, а также на эмбеддингах и модели GigaChat. Также, реализовано кеширование векторной базы - она будет построена лишь один раз и сохранена локально. В случае, если запуск будет произведен повторно и при этом чанки будут теми же, векторная база будет подгружена, что позволит сэкономить и время, и токены :)

## Метрики проекта (валидация RAG)

Подробнее о том, как вычислялись метрики, можно посмотреть по [ссылке](https://github.com/LadaNikitina/BookRAG/tree/metrics).

### **1. Faithfulness (достоверность)**  
**Faithfulness** — метрика, которая измеряет, насколько точно и достоверно ответ (или генерация) основан на предоставленном контексте. Она проверяет соответствие информации в ответе исходным данным, выявляя неточные или вымышленные утверждения.  

**Задачи Faithfulness:**  
- Сравнение ответа с контекстом.  
- Выявление галлюцинаций.  
- Проверка точности цитирования.  

### **2. Answer Relevancy (релевантность ответа)**  
**Answer relevancy** — метрика, оценивающая, насколько ответ модели релевантен заданному вопросу. Она определяет, отвечает ли модель на вопрос по существу, избегая отклонений от темы.  

**Задачи Answer Relevancy:**  
- Соответствие вопросу.  
- Отсутствие лишней информации в ответе.  
- Полнота ответа.  

### **Результаты тестирования**  
При использовании модели от OpenAI удалось достичь следующих показателей:  
- **Answer relevancy** — **0.91**  
- **Faithfulness** — **0.71**  

Эти результаты демонстрируют высокую релевантность ответов при умеренном уровне достоверности, что указывает на необходимость дальнейших улучшений в точности цитирования и предотвращении галлюцинаций.  

При использовании же модели от Gigachat удалось достичь следующих показателей:  
- **Answer relevancy** — **0.79**  
- **Faithfulness** — **0.52**

Модель GigaChat демонстрирует умеренную релевантность при низкой достоверности, что также указывает на необходимость доработки в точности цитирования и предотвращении галлюцинаций.

## Запуск приложения

### GigaChat API key

Для генерации ответов на вопросы наше решение использует модель GigaChat-Pro и эмбеддинги от GigaChat, поэтому для использования чат-бота требуется
иметь собственный GigaChat API ключ, который может быть сгенерирован здесь: https://developers.sber.ru/studio/workspaces/my-space/get/gigachat-api

### Клонирование репозитория

```
git clone git@github.com:LadaNikitina/BookRAG.git -b gigachat-main
cd BookRAG
```

### Установка зависимостей

```
python3 -m venv venv
source venv/bin/activate  # Для macOS/Linux
# или
venv\Scripts\activate     # Для Windows

pip install -r requirements.txt
```

### Запуск и setup

Для запуска приложения воспользуйтесь командой:

`streamlit run app.py
`

Steamlit-приложение автоматически развернется в вашем браузере на localhost.

Введите ваш GigaChat API ключ в соответствующее поле в интерфейсе веб-приложения:

![image](https://github.com/user-attachments/assets/d406201d-9a9b-4c3e-a483-85561304a269)

После ввода корректного ключа будет произведена индексация книги и построена векторная база, необходимая для работы RAG.
После этого можно пользоваться чат-ботом и задавать интересующие вопросы.

## Работа приложения

В соответствующем поле введите ваш вопрос по книге Ф.М. Достоевского "Братья Карамазовы". Чатбот вернет ответ, состоящий
из непосредственно ответа на поставленный вопрос, цитат из текста книги и источников цитат.

![image](https://github.com/user-attachments/assets/493901b8-ec53-47b6-985d-839abea680f9)

Наше приложение позволяет задавать неограниченное количество вопросов, поддерживая с ботом длительный диалог.

![image](https://github.com/user-attachments/assets/55070b96-bdad-4980-8465-1a77749ac951)

Для завершения диалога с чат-ботом введите "exit"/"выход"/"quit".

![image](https://github.com/user-attachments/assets/3cafe8f7-ec8d-44fe-8bf0-9e3f529a65e7)

